---
title: "College Major Backgrounds and Effects"
author: "Dylan Holliday and Max Collins"
date: "May 5, 2025"
date-modified: now
format: 
  pdf:
    embed-resources: true
    number-sections: false
    toc: false
    fig-align: center
    cap-location: top
    link-external-newwindow: true
execute: 
  echo: false
  warning: false
---

# Research Topic: College Majors

Our Research is focused on finding trends and insights from post-secondary majors: how one's socioeconomic status plays a role in their major, as well as their major's effect on their income after graduation. This is a topic of interest for our team because we are in college and are thus interested in how different majors contain different groups of people and how the choice of a college major can affect one's future career. We will explore these relationships using a series of data visualizations and provide insights on income and diversity trends of recent college graduates. Our underlying purpose is to expose societal trends that may be hindering diversity initiatives in order to become a basis for possible change.

# Research Questions

(Enter Research Questions Here)

# Provenance of Our Data

# FAIR and CARE Principles

# Attribute Focus

Our analysis will focus on median salary, major categories (majors grouped within a similar field), unemployment rate, total amount of graduates, and the sex and race backgrounds of certain majors.

```{r}
#1 Open Necessary Packages
library(tidyr)
library(readr)
library(dplyr)
library(ggplot2)
library(readxl)
library(janitor)
library(knitr)
library(kableExtra)

#2 Read in earnings data from url, diversity data from xlsx path

recentGrads <- read_csv("https://raw.githubusercontent.com/DJH6655/STAT184-Final-Project/refs/heads/main/recent-grads.csv")

sexRaceFreqRaw <- read_excel("Tab1_FOD (1).xlsx")

#3 Clean Excel Data, Selecting necessary attributes
sexRaceFrequency <- sexRaceFreqRaw %>% 
  slice_head(n=41) %>% 
  slice_tail(n = 37) %>% 
  select(c(1,2,9,10,11,12,21,22)) %>% 
  rename(
    Major = 1,
    Total = 2,
    ##Rename to count due to mutate operation
    Race_White_Percent = 3, 
    Race_Black_Percent = 4,
    Race_Asian_Percent = 5,
    Race_Hispanic_Percent= 6,
    Poverty_Percent = 7,
    Not_Poverty_Percent = 8
  ) %>% 
  filter(!is.na(Total)) %>% 
  slice(c(-14,-20,-23)) %>% 
  mutate(Major = toupper(Major),
         Total = as.numeric(Total),
         Race_White_Percent = as.numeric(Race_White_Percent),
         Race_Black_Percent = as.numeric(Race_Black_Percent),
         Race_Asian_Percent = as.numeric(Race_Asian_Percent),
         Race_Hispanic_Percent = as.numeric(Race_Hispanic_Percent),
         Poverty_Percent = as.numeric(Poverty_Percent),
         Not_Poverty_Percent = as.numeric(Not_Poverty_Percent)
         )

# Count Table
sexRaceCount <- sexRaceFrequency %>%
  mutate(
    Race_White_Count = floor((Race_White_Percent / 100)*Total),
    Race_Black_Count = floor((Race_Black_Percent / 100)*Total),
    Race_Asian_Count = floor((Race_Asian_Percent / 100)*Total),
    Race_Hispanic_Count = floor((Race_Hispanic_Percent / 100)*Total),
    Poverty_Count = floor((Poverty_Percent / 100)*Total),
    Not_Poverty_Count = floor((Not_Poverty_Percent / 100)*Total)
  )

# Join our two dataframes together
joinedTables <-
  inner_join(
    sexRaceCount,
    recentGrads,
    by = join_by(Major == Major)
  ) 

majorCategories <- joinedTables %>% 
  group_by(Major_category) %>%
  summarize(
    count = sum(Total.x),
    avg_P25 = mean(P25th),
    avg_med_sal = mean(Median),
    avg_P75 = mean(P75th),
    avg_umemp_rate = mean(Unemployment_rate),
    white = floor(mean(Race_White_Count)),
    black = floor(mean(Race_Black_Count)),
    asian = floor(mean(Race_Asian_Count)),
    hispanic = floor(mean(Race_Hispanic_Count)),
    poverty = floor(mean(Poverty_Count)),
    not_poverty = floor(mean(Not_Poverty_Count))
  )



```

You can add options to executable code like this

```{r}
### Make a Race/Major Category frequency table

#1 Select Necessary attributes and pivot longer
freqTablePrep <- majorCategories %>%
  select(1,7,8,9,10) %>%
  pivot_longer(!Major_category, names_to = "Race", values_to = "Count")
  
#2 Use uncount to have a case be one individual
byStudent <- uncount(freqTablePrep, Count)

#3 Formats frequency table and relative frequencies
raceFreq <- byStudent %>% 
  tabyl(Major_category, Race) %>%
  adorn_totals(where = "col") %>%
  arrange(desc(Total)) %>%
  adorn_totals(where = "row") %>%
  adorn_percentages(denominator = "all") %>%
  adorn_pct_formatting(digits = 2) %>%
  adorn_title(
    placement = "combined",
    row_name = "Major Category",
    col_name = "Race"
  )

#4 Outputs a stylized table
raceFreq %>%
  kable(
    caption = "Frequency of Each Major Category Based on Race",
    booktabs = TRUE,
    align = "l"
  ) %>%
  kableExtra::kable_styling(
    bootstrap_options = c("striped", "condensed"),
    font_size = 12
  ) 
```

The `echo: false` option disables the printing of code (only output is displayed).

```{r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```
