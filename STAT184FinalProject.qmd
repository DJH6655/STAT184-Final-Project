---
title: "College Major Backgrounds and Effects"
author: "Dylan Holliday and Max Collins"
date: "May 7, 2025"
date-modified: now
format: 
  pdf:
    embed-resources: true
    number-sections: false
    toc: false
    fig-align: center
    cap-location: top
    link-external-newwindow: true
execute: 
  echo: false
  warning: false
---

# Research Topic: College Majors

Our Research is focused on finding trends and insights from post-secondary majors: how one's socioeconomic status plays a role in their major, as well as their major's effect on their income after graduation. This is a topic of interest for our team because we are in college and are thus interested in how different majors contain different groups of people and how the choice of a college major can affect one's future career. We will explore these relationships using a series of data visualizations and provide insights on income and diversity trends of recent college graduates. Our underlying purpose is to expose societal trends that may be hindering diversity initiatives in order to become a basis for possible change.

# Research Questions

(Enter Research Questions Here)

# Provenance of Our Data

# FAIR and CARE Principles

# Attribute Focus

Our analysis will focus on median salary, major categories (majors grouped within a similar field), unemployment rate, total amount of graduates, and the sex and race backgrounds of certain majors.

```{r}
#1 Open Necessary Packages
library(tidyr)
library(readr)
library(dplyr)
library(rvest)
library(tidyverse)
library(ggplot2)
library(readxl)
library(janitor)
library(knitr)
library(kableExtra)

#2 Read in earnings data from url, diversity data from xlsx path

# Read in income data
recentGrads <- read_csv(
  # Separate string for visibility
  str_c("https://raw.githubusercontent.com/DJH6655",
        "/STAT184-Final-Project/refs/heads/main/recent-grads.csv"))

# Read in secondary data source
sexRaceFreqRaw <- read_excel("Tab1_FOD (1).xlsx")


#3 Clean Excel Data, Selecting necessary attributes and renaming them
sexRaceFrequency <- sexRaceFreqRaw %>% 
  slice_head(n=41) %>% 
  slice_tail(n = 37) %>% 
  select(c(1,2,9,10,11,12,21,22)) %>% 
  rename(
    Major = 1,
    Total = 2,
    Race_White_Percent = 3, 
    Race_Black_Percent = 4,
    Race_Asian_Percent = 5,
    Race_Hispanic_Percent= 6,
    Poverty_Percent = 7,
    Not_Poverty_Percent = 8
  ) %>% 
  filter(!is.na(Total)) %>% 
  slice(c(-14,-20,-23)) %>% 
  mutate(Major = toupper(Major),
         Total = as.numeric(Total),
         Race_White_Percent = as.numeric(Race_White_Percent),
         Race_Black_Percent = as.numeric(Race_Black_Percent),
         Race_Asian_Percent = as.numeric(Race_Asian_Percent),
         Race_Hispanic_Percent = as.numeric(Race_Hispanic_Percent),
         Poverty_Percent = as.numeric(Poverty_Percent),
         Not_Poverty_Percent = as.numeric(Not_Poverty_Percent)
         )

# Count Table
sexRaceCount <- sexRaceFrequency %>%
  mutate(
    Race_White_Count = floor((Race_White_Percent / 100)*Total),
    Race_Black_Count = floor((Race_Black_Percent / 100)*Total),
    Race_Asian_Count = floor((Race_Asian_Percent / 100)*Total),
    Race_Hispanic_Count = floor((Race_Hispanic_Percent / 100)*Total),
    Poverty_Count = floor((Poverty_Percent / 100)*Total),
    Not_Poverty_Count = floor((Not_Poverty_Percent / 100)*Total)
  )

# Join our two dataframes together
joinedTables <-
  inner_join(
    sexRaceCount,
    recentGrads,
    by = join_by(Major == Major)
  ) 

# Make a Summary Table
majorCategories <- joinedTables %>% 
  group_by(Major_category) %>%
  summarize(
    count = sum(Total.x),
    avg_P25 = mean(P25th),
    avg_med_sal = mean(Median),
    avg_P75 = mean(P75th),
    avg_umemp_rate = mean(Unemployment_rate),
    White = floor(mean(Race_White_Count)),
    Black = floor(mean(Race_Black_Count)),
    Asian = floor(mean(Race_Asian_Count)),
    Hispanic = floor(mean(Race_Hispanic_Count)),
    poverty = floor(mean(Poverty_Count)),
    not_poverty = floor(mean(Not_Poverty_Count))
  )



```

## An Analysis of Race Frequency among Major Categories

This analysis will try to determine if there is a statistically significant bias towards people of white ethnicity in a college setting by comparing the collegiate white race percentage with the national white race percentage. We will be conducting a One Sample Proportion Z-Test to make our conclusion.

**Hypotheses**:  

  $H_0$ : $p = p_0$ There is no significant difference in collegiate race proportions and national (population) race proportions.  
  $H_a$ : $p \ne p_0)$ There exists a significant difference in proportions of race between college students and the national (population) average.  
  
To start, we must find the proportion of white college students. The proportion lies in the table below.

Below is a table depicting the percent frequency of each race in each major category as a portion of the sample population.

```{r}
### Make a Race/Major Category frequency table

#1 Select Necessary attributes and pivot longer
freqTablePrep <- majorCategories %>%
  select(1,7,8,9,10) %>%
  pivot_longer(!Major_category, names_to = "Race", values_to = "Count")
  
#2 Use uncount to have a case be one individual
byStudent <- uncount(freqTablePrep, Count)

#3 Formats frequency table and relative frequencies
raceFreq <- byStudent %>% 
  tabyl(Major_category, Race) %>%
  adorn_totals(where = "col") %>%
  arrange(desc(Total)) %>%
  adorn_totals(where = "row") %>%
  adorn_percentages(denominator = "all") %>%
  adorn_pct_formatting(digits = 2) %>%
  adorn_title(
    placement = "combined",
    row_name = "Major Category",
    col_name = "Race"
  )

#4 Outputs a stylized table
raceFreq %>%
  kable(
    caption = "Frequency of Each Major Category Based on Race",
    booktabs = TRUE,
    align = "lrrrrr"
  ) 
```

As one can tell, there is a clear disparity between the proportion of white students and the proportion of students of different races, with the total percentage of white college students being 67.25%. Another noteworthy finding is that 20.49% of Asian students have a major in the Computers and Mathematics Category, as opposed to just 8.13% of the whole collegiate population. This percentage can be obtained by taking the 2.5% of Asians in Computers & Mathematics and divide by the 12.2% of total Asian students in the collegiate population. This statistic tells us that Asians are more likely to have a major in Computers and Mathematics than the college population as a whole. Even still, everyone should avoid stereotyping so that all people have free choice to study whatever they choose.  

Back to our analysis, the college proportion of white students is 67.25%. Let's call this $p_0$. According to the US Census, 63.44% of the total United States population identifies as white. Let's call this $p$. According to the One Sample Proportion Z-Test:  
  
  $$z = \frac{p-p_0}{\sqrt{p_0(1-p_0)/n}}$$  
  
Where $p_0$ is the white college students proportion, $p$ is the total white US population proportion, and $n$ is the total number of college students in the sample:  
 `r sum(majorCategories['count'])`
 
As such, our z value is calculated to be:

$$ z = -471.27 $$
Since our z value is so large, our p-value is 0, leading us to reject our null hypothesis. This leads us to believe there is a statistical difference in the proportion of white college students and the proportion of the US Population that is white.

# Conclusions

# References
https://www.neilsberg.com/insights/united-states-population-by-race/#:~:text=The%20percent%20distribution%20of%20United%20States%20population%20by,are%20some%20other%20race%20and%2010.71%25%20are%20multiracial.

```{r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
```
